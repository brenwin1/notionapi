---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# notionapi

<!-- badges: start -->
<!-- badges: end -->

notionapi is an R client library for [Notion API](https://developers.notion.com/), enabling users to programmatically interact with their Notion workspaces. The package provides complete API coverage for managing pages and databases, managing content blocks, handling comments and retrieving user information.

The package is designed to mirror the [Official Notion JavaScript Client](https://github.com/makenotion/notion-sdk-js), using R6 classes to provide a familiar object-oriented interface and consistent API structure.

## Installation

Install the package from CRAN:

```{r}
#| eval: false
install.packages("notionapi")
```

Or install the development version from GitHub:

```{r}
#| eval: false
pak::pak("brenwin1/notionapi")
```

## Authentication

To initialise the Notion client, you need a Notion integration token.

1. **Create an integration** in your Notion workspace following [these instructions](https://developers.notion.com/docs/authorization#internal-integration-auth-flow-set-up).

2. **Copy the integration token** from your integration settings.

3. **Set the token** as an environment variable:

```{r}
#| eval: FALSE
usethis::edit_r_environ()
# add NOTION_TOKEN=<your_integration_token>
```

4. [Share pages/databases](https://developers.notion.com/docs/authorization#integration-permissions) with your integration in Notion.

5. Create your client:

```{r}
#| eval: FALSE
library(notionapi)

notion <- notion_client()
```

## Usage

Use `notion_client()` or `async_notion_client()` to create a client instance for accessing all the API endpoints: 

The client organises methods into logical endpoint groups like pages, databases, and blocks. 
Each method maps directly to a Notion API endpoint, with all parameters available as function arguments.

See [Notion API reference](https://developers.notion.com/reference/intro) for complete endpoint documentation.

```{r}
library(notionapi)

# Create a Notion client instance
notion <- notion_client()

# Access the users endpoint to list all users in your Notion workspace
notion$users$list()
```

### Serialisation

R data structures are automatically converted to the JSON format expected by the Notion API:

- `lists` -> JSON object
- `list of lists` -> JSON array

Examples can be found throughout the [reference documentation](reference/). For example, see [CommentsEndpoint create()](reference/CommentsEndpoint.html#ref-examples) method.

### Pagination

See [Pagination](https://developers.notion.com/reference/intro#pagination) section in Notion API documentation for supported endpoints and implementation details. 

Pagination parameters (`page_size` and `start_cursor`) are exposed as function arguments. 

For an example, see [BlocksChildrenEndpoint retrieve()](reference/BlocksChildrenEndpoint.html#ref-examples) method.